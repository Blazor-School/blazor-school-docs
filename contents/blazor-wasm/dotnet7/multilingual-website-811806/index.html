<h1>Multilingual website</h1>
<p>🟨 Slightly different to Blazor Server</p>
<p>If you're looking to expand your website's reach and cater to an international audience, creating a multilingual website is an excellent strategy. In this tutorial, we'll guide you through the process of building a Blazor application that can support multiple languages.</p>
<ul>
    <li>How multilingual works in Blazor WebAssembly?</li>
    <li>Key considerations when creating a multilingual website.</li>
    <li>Language selection strategies.</li>
    <li>Translation approaches.</li>
    <li>Resource loading approaches.</li>
    <li>Project preparation.</li>
    <li>Key differences between Blazor WebAssembly and Blazor Server.</li>
</ul>
<blockquote>You can <a href="https://github.com/Blazor-School/multilingual-blazor-wasm-dotnet7" target="_blank" rel="noopener">download the example</a> code used in this topic on GitHub.</blockquote>
<hr class="my-4" />
<h1>How multilingual works in Blazor WebAssembly?</h1>
<p>Multilingual works can be achieved in four steps:</p>
<ol>
    <li>Identifying the language associated with the region: Since a country may have multiple languages, Blazor WebAssembly uses <code>CultureInfo.DefaultThreadCurrentCulture</code> and <code>CultureInfo.DefaultThreadCurrentUICulture</code> to determine the current region.Here is an example language tag, <strong>en-US</strong>: The <strong>en</strong> indicates that the language is English, and the <strong>US</strong> indicates that the language is used in America. You can find a list of language tags on <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c" target="_blank" rel="noopener" title="Microsoft Learn">Microsoft Learn</a>. Although it is a rare case, you may need to create your own language and location, but that part is not included in this tutorial.</li>
    <li>Locating the corresponding resource file using a key: Resource files can be in various formats such as <strong>.resx</strong>, <strong>.json</strong>, <strong>.yml</strong>, etc. and their structure may differ as well. Translated keys may be nested, such as <code>Index.HelloWorld</code> or a flat format like <code>HelloWorld</code> or even spread across multiple files.</li>
    <li>Using parameters in addition to the key to translate the text: For example, in Chinese, the 31st day is "日31," while in English, it is "31st."</li>
    <li>Displaying the translated text.</li>
</ol>
<hr class="my-4" />
<h1>Key considerations when creating a multilingual website</h1>
<p>The most important thing to keep in mind when creating a multilingual website are:</p>
<ol>
    <li>Language selection strategy.</li>
    <li>Translation approach.</li>
</ol>
<hr class="my-4" />
<h1>Language selection strategies</h1>
<p>When creating a multilingual website, developers can use different methods to determine the user's preferred language, such as cookies, browser language, local storage, or the language in the URL. For example, if a user in France visits a website with their browser language set to French, the website can detect this and display the website content in French by default.</p>
<p>However, conflicts may arise when these methods produce different results for the user's preferred language. For instance, if a user's browser language is set to French, but they have previously selected English as their preferred language in the website's settings, there may be a conflict between the two methods.</p>
<p>To resolve such conflicts, developers can prioritize one method over others based on factors such as the reliability of the data source and the user's past language selection history. For instance, if the user has consistently chosen English as their preferred language in the website's settings, the website can prioritize that selection over their browser language.</p>
<hr class="my-4" />
<h1>Translation approaches</h1>
<p>There are 2 approaches to translation in Blazor:</p>
<ol>
    <li><strong>Deferred translation</strong>: When a user selects a language, the website saves it as a preference and remembers it for future visits. However, the language selection may not take effect until the user refreshes the website.</li>
</ol>
<div class="ratio ratio-21x9">
    <video width="300" height="150" controls="controls">
        <source src="contents\blazor-wasm\dotnet7\multilingual-website-811806\deferred-translation.webm" />
    </video>
</div>
<ol start="2">
    <li><strong>Instant translation</strong>: With instant translation, when a user selects a language, Blazor immediately updates and renders the web page in the selected language without requiring the user to refresh the website.</li>
</ol>
<div class="ratio ratio-21x9">
    <video width="300" height="150" controls="controls">
        <source src="contents\blazor-wasm\dotnet7\multilingual-website-811806\instant-translation.webm" />
    </video>
</div>
<hr class="my-4" />
<h1>Resource loading approaches</h1>
<p>Resource loading strategies are an essential aspect of translation in Blazor. Resources typically contain collections of keys and values for a specific language, and a website with multiple languages and components will require multiple resource files to be loaded. There are 2 resource loading approaches for Blazor WebAssembly:</p>
<ul>
    <li><strong>Eager loading (not recommended)</strong>: This strategy involves loading all resource files (<strong>.resx</strong> files) at the initial load of the website. However, if a user requests only one component, all 40 resource files will still be loaded. This strategy is not recommended due to the significant overhead and can be used with any translation approach.</li>
    <li><strong>Lazy loading (recommended)</strong>: This strategy loads only the requested resource files, and the loaded files are cached in the browser memory. Thus, if a user changes the language, the resource files don't need to be loaded again. Resource files can have different extensions like <strong>.json</strong> and <strong>.yml</strong> or any other file formats. For example, if a website has 10 components in 3 languages and a user requests 1 component, only 1 resource file will be loaded. This strategy is recommended and can only be used with the <strong>Instant Translation</strong> approach.</li>
</ul>
<hr class="my-4" />
<h1>Project preparation</h1>
<ol>
    <li>Install the Microsoft.Extensions.Localization NuGet library.</li>
    <li>To modify the csproj.cs file, right-click on your project and select <strong>Edit Project File</strong>. Then, add the following code to the file:</li>
</ol>
<p><img src="contents\blazor-wasm\dotnet7\multilingual-website-811806\edit-csproj-file.png" alt="edit-csproj-file.png" width="429" height="567" /></p>
<pre class="code" language="html">&lt;PropertyGroup&gt;
    ...
    &lt;BlazorWebAssemblyLoadAllGlobalizationData&gt;true&lt;/BlazorWebAssemblyLoadAllGlobalizationData&gt;
&lt;/PropertyGroup&gt;</pre>
<ol start="3">
    <li>In your component, inject <code>IStringLocalizer&lt;T&gt;</code>, where <code>T</code> represents your component type and uses <code>IStringLocalizer&lt;T&gt;</code> to display text in multiple languages.. For example, in <strong>ChangeLanguageDemonstrate.razor</strong>:</li>
</ol>
<pre class="code" language="razor">@inject IStringLocalizer&lt;ChangeLanguageDemonstrate&gt; Localizer

@Localizer["String1"]</pre>
<p>In the example above, <code>String1</code> is your resource key.</p>
<ol start="5">
    <li>Implement a translation approach, which will be covered in the next tutorial.</li>
</ol>
<p>You can also pass parameters to the localizer. To do this, add a placeholder in the translated text, such as <code>"Hello {0}, {1}"</code>. Then, use <code>@Localizer["Hello {0}, {1}", "Blazor School", "Blazor School Books"]</code> to replace the placeholder with parameters.</p>
<hr class="my-4" />
<h1>Key differences between Blazor WebAssembly and Blazor Server</h1>
<div class="flex flex-grow flex-col gap-3">
    <div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">
        <div class="markdown prose w-full break-words dark:prose-invert light">
            <p>When working with Blazor Server, you'll need to use <code>CultureInfo.CurrentCulture</code> and <code>CultureInfo.CurrentUICulture</code>, rather than <code>CultureInfo.DefaultThreadCurrentCulture</code> and <code>CultureInfo.DefaultThreadCurrentUICulture</code> as you would with Blazor WebAssembly. Additionally, the project preparation steps are completely different.</p>
        </div>
    </div>
</div>